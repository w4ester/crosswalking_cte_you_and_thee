<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Arts, Media & Communication ‚Äî Crosswalk</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    --bg: #fff;
    --ink:#1f2937;
    --muted:#576071;
    --line:#e6e6ea;
    --pill-bg:#eef2ff;
    --pill-bd:#dbe3ff;
    --chip-bg:#eef4ff;
    --chip-bd:#dbe6ff;
    --hot1:#b91c1c;  /* deep red */
    --hot2:#f59e0b;  /* amber */
    --btn:#0f62fe;  /* IBM blue */
  }

  *{ box-sizing:border-box; }
  html,body{ margin:0; padding:0; background:#faf7f5; color:var(--ink); font: 16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }

  /* Top gradient masthead (like PSS) */
  .masthead{
    background: linear-gradient(135deg, var(--hot1) 0%, #e24a1f 40%, var(--hot2) 100%);
    color:#fff; padding: 18px 0 28px;
    border-bottom: 1px solid rgba(255,255,255,.25);
  }
  .wrap{ max-width: 1200px; margin:0 auto; padding:0 14px; }

  /* Nav pills */
  .nav{
    display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin-bottom:10px;
  }
  .pill{
    display:inline-block; padding:6px 12px; border-radius:999px;
    background: rgba(255,255,255,.12); color:#fff; text-decoration:none; border:1px solid rgba(255,255,255,.25);
  }
  .pill:hover{ background: rgba(255,255,255,.2); }
  .pill.active{ background:#fff; color:#000; border-color:#fff; }

  h1{ margin:6px 0 0; font-size: 1.75rem; }

  /* Chips under title */
  .chips{ display:flex; flex-wrap:wrap; gap:6px; margin-top:6px; }
  .chip{ border:1px solid rgba(255,255,255,.65); color:#fff; background:transparent; border-radius:999px; padding:2px 10px; font-size:.82rem; }

  /* Metric cards (like PSS counters) */
  .metrics{
    display:grid; grid-template-columns: repeat(5, minmax(140px,1fr));
    gap: 12px; margin-top: 16px;
  }
  .metric{
    background:#fff; color:#000; border-radius:10px; padding:12px; border:1px solid #f0f0f1;
    box-shadow: 0 1px 0 rgba(0,0,0,.05);
  }
  .metric h3{ margin:0; font-size:1.8rem; }
  .metric .label{ color:#6b7280; font-size:.9rem; margin-top:2px; }

  main{ max-width:1200px; margin: 14px auto; padding: 0 14px 40px; }

  /* Controls row */
  .controls{
    display:flex; flex-wrap:wrap; gap:10px 14px; align-items:flex-end; margin: 14px 0;
  }
  .controls label{ font-size:.92rem; color:#2e3440; display:flex; flex-direction:column; gap:6px; }
  select,input[type="search"]{
    min-height: 36px; border:1px solid var(--line); border-radius:8px; padding:6px 10px; background:#fff; min-width: 220px;
  }
  .btn{ display:inline-block; padding:8px 12px; border-radius:8px; border:1px solid #cbd5e1; background:#f3f4f6; cursor:pointer; font-size:.95rem; }
  .btn.primary{ background: var(--btn); border-color: var(--btn); color:#fff; }
  .btn.warn{ background: #ef4444; border-color:#ef4444; color:#fff; }

  /* Table */
  .table-wrap{ background:#fff; border:1px solid #ececf1; border-radius:12px; overflow:hidden; }
  table{ width:100%; border-collapse:collapse; }
  thead th{
    position:sticky; top:0; background:#f9fbff; z-index:1; border-bottom:1px solid #e8ecf3; padding:10px 8px; text-align:left; font-weight:700;
  }
  tbody td{ border-bottom:1px solid #f1f3f6; padding:10px 8px; vertical-align:top; }
  tbody tr:nth-child(2n){ background:#fcfdff; }
  .muted{ color: var(--muted); }
  .badge{
    display:inline-block; padding:2px 8px; border-radius:6px; font-size:.78rem; font-weight:700; letter-spacing:.02em;
  }
  .badge.cc{ background:#e6f0ff; color:#0b4bdb; border:1px solid #d5e4ff; }
  .badge.univ{ background:#efe9ff; color:#6a2fda; border:1px solid #e4dbff; }
  .badge.priv{ background:#fff2e5; color:#b45309; border:1px solid #ffe6cc; }
  .tag{
    background:var(--chip-bg); border:1px solid var(--chip-bd); border-radius:4px; padding:2px 6px; font-size:.78rem; margin-right:6px; white-space:nowrap; display:inline-block;
  }

  /* ‚ÄúSource / View‚Äù link */
  .view-link{
    display:inline-block; padding:6px 10px; border-radius:8px; background:#eef2ff; border:1px solid #dbe3ff; text-decoration:none; font-weight:600;
  }

  @media (max-width:980px){
    .metrics{ grid-template-columns: repeat(2, 1fr); }
    select,input[type="search"]{ min-width: 160px; }
  }

  @media print{
    .masthead, .controls { display:none !important; }
    body{ background:#fff; }
    .table-wrap{ border:0; }
    thead th{ position:static; }
  }
</style>
</head>
<body>

<!-- MASTHEAD: gradient like PSS -->
<div class="masthead">
  <div class="wrap">
    <nav class="nav" aria-label="Main">
      <a class="pill" href="./index.html">Home</a>
      <a class="pill" href="./dt-crosswalk-table.html">Digital Technology</a>
      <a class="pill" href="./003_ed_crosswalk-table.html">Education</a>
      <a class="pill" href="./enr-crosswalk-table.html">ENR</a>
      <a class="pill" href="./pss_crosswalk.html">PSS</a>
      <a class="pill active" href="./amc-crosswalk-table.html" aria-current="page">Arts, Media &amp; Communication</a>
    </nav>

    <h1>Arts, Media &amp; Communication</h1>
    <div class="chips">
      <span class="chip">Animation &amp; Game Development</span>
      <span class="chip">Graphic Communications</span>
      <span class="chip">Video &amp; Audio Production</span>
    </div>

    <!-- COUNTERS (like PSS) -->
    <div class="metrics" role="region" aria-label="Summary metrics">
      <div class="metric"><h3 id="m-total">0</h3><div class="label">Total Programs</div></div>
      <div class="metric"><h3 id="m-cc">0</h3><div class="label">Community Colleges</div></div>
      <div class="metric"><h3 id="m-univ">0</h3><div class="label">Universities</div></div>
      <div class="metric"><h3 id="m-private">0</h3><div class="label">Private</div></div>
      <div class="metric"><h3 id="m-cert">0</h3><div class="label">With Certificates (LDC)</div></div>
    </div>
  </div>
</div>

<main class="wrap">
  <!-- CONTROLS: Reset | Export to Excel | Print (parity with others) -->
  <div class="controls">
    <label>Pathway
      <select id="pathway">
        <option value="">All</option>
        <option>Animation &amp; Game Dev</option>
        <option>Graphic Communications</option>
        <option>Video &amp; Audio</option>
      </select>
    </label>

    <label>Institution Type
      <select id="itype">
        <option value="">All</option>
        <option>Community College</option>
        <option>University</option>
        <option>Private</option>
      </select>
    </label>

    <label>Credential Tag
      <select id="cred">
        <option value="">Any</option>
        <option>Adobe ACP</option>
        <option>Avid</option>
        <option>Blackmagic</option>
        <option>Unity</option>
        <option>Unreal</option>
        <option>Autodesk</option>
        <option>Blender</option>
        <option>Apple FCP</option>
      </select>
    </label>

    <label>Search
      <input id="q" type="search" placeholder="Institution, program, notes‚Ä¶" />
    </label>

    <button id="btn-reset" class="btn">Reset Filters</button>
    <button id="btn-export" class="btn primary">Export to Excel</button>
    <button id="btn-print" class="btn">üñ®Ô∏è Print</button>
  </div>

  <!-- TABLE -->
  <div class="table-wrap">
    <table id="tbl" aria-describedby="table-caption">
      <caption id="table-caption" class="visually-hidden">Arts, Media & Communication crosswalk table</caption>
      <thead>
        <tr>
          <th>Pathway</th>
          <th>Institution</th>
          <th>Sector</th>
          <th>Degree</th>
          <th>Program/Major</th>
          <th>Lower Division Certificates</th>
          <th>Credential Content in Major?</th>
          <th>Source</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</main>

<script>
(async function(){
  const DATA_URL = 'AMC_Cluster_Crosswalk.csv'; // CSV at repo root

  // --- Load CSV ---
  const csvText = await fetch(DATA_URL).then(r=>{
    if(!r.ok) throw new Error('CSV not found: '+DATA_URL);
    return r.text();
  });

  const rows = parseCSV(csvText);
  const records = toObjects(rows).map(normalize);

  // --- Elements ---
  const els = {
    tbody: document.querySelector('#tbl tbody'),
    pathway: document.getElementById('pathway'),
    itype: document.getElementById('itype'),
    cred: document.getElementById('cred'),
    q: document.getElementById('q'),
    resetBtn: document.getElementById('btn-reset'),
    exportBtn: document.getElementById('btn-export'),
    printBtn: document.getElementById('btn-print'),
    mTotal: document.getElementById('m-total'),
    mCC: document.getElementById('m-cc'),
    mUniv: document.getElementById('m-univ'),
    mPriv: document.getElementById('m-private'),
    mCert: document.getElementById('m-cert'),
  };

  // --- Prefilter from index cards (query params) ---
  const params = new URLSearchParams(location.search);
  if(params.get('pathway')) els.pathway.value = params.get('pathway');
  if(params.get('type')) els.itype.value = params.get('type');
  if(params.get('credential')) els.cred.value = params.get('credential');
  if(params.get('q')) els.q.value = params.get('q');

  // --- Render ---
  function render(){
    const q = els.q.value.trim().toLowerCase();

    const filt = records.filter(r=>{
      if(els.pathway.value && r.Pathway !== els.pathway.value) return false;
      if(els.itype.value && r.Institution_Type !== els.itype.value) return false;
      if(els.cred.value){
        const tags = (r.Credential_Tags||'').split('|').map(x=>x.trim());
        if(!tags.includes(els.cred.value)) return false;
      }
      if(q){
        const hay = (r.Institution+' '+r.Program_Name+' '+(r.Notes||'')).toLowerCase();
        if(!hay.includes(q)) return false;
      }
      return true;
    });

    // Counters
    els.mTotal.textContent = filt.length;
    els.mCC.textContent = filt.filter(r=>r.Institution_Type==='Community College').length;
    els.mUniv.textContent = filt.filter(r=>r.Institution_Type==='University').length;
    els.mPriv.textContent = filt.filter(r=>r.Institution_Type==='Private').length;
    els.mCert.textContent = filt.filter(r =>
      (r.Has_LDC_Certificate===true) ||
      (String(r.Award||'').toLowerCase().includes('certificate'))
    ).length;

    // Rows
    els.tbody.innerHTML = '';
    for(const r of filt){
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${safe(r.Pathway)}</td>
        <td>${safe(r.Institution)}</td>
        <td>${sectorBadge(r.Institution_Type)}</td>
        <td>${safe(r.Award)}</td>
        <td><strong>${safe(r.Program_Name)}</strong></td>
        <td>${ldcCell(r)}</td>
        <td>${credCell(r.Credential_Tags)}</td>
        <td>${sourceCell(r)}</td>
      `;
      els.tbody.appendChild(tr);
    }
  }

  // Events
  ['change','keyup'].forEach(ev=>{
    els.pathway.addEventListener(ev, render);
    els.itype.addEventListener(ev, render);
    els.cred.addEventListener(ev, render);
    els.q.addEventListener(ev, render);
  });

  els.resetBtn.addEventListener('click', ()=>{
    els.pathway.value = '';
    els.itype.value = '';
    els.cred.value = '';
    els.q.value = '';
    history.replaceState({}, '', location.pathname); // clear params
    render();
  });

  els.exportBtn.addEventListener('click', exportToExcel);
  els.printBtn.addEventListener('click', ()=> window.print());

  render();

  // --- Helpers ---
  function normalize(o){
    const t = x => String(x||'').trim().toUpperCase();
    return {
      ...o,
      Direct_Program: t(o.Direct_Program)==='TRUE',
      Has_LDC_Certificate: t(o.Has_LDC_Certificate)==='TRUE'
    };
  }
  function ldcCell(r){
    const yes = (r.Has_LDC_Certificate===true) || (String(r.Award||'').toLowerCase().includes('certificate'));
    return yes ? '<span class="badge cc">Yes</span>' : '<span class="muted">‚Äî</span>';
  }
  function credCell(tags){
    if(!tags) return '<span class="muted">‚Äî</span>';
    return String(tags).split('|').map(s=>`<span class="tag">${safe(s.trim())}</span>`).join(' ');
  }
  function sourceCell(r){
    const p = (r.Program_URL||'').trim();
    const e = (r.Evidence_URL||'').trim();
    const first = p || e;
    if(!first) return '<span class="muted">‚Äî</span>';
    return `<a class="view-link" href="${safeAttr(first)}" target="_blank" rel="noopener">View</a>`;
  }
  function sectorBadge(s){
    const v = String(s||'').trim();
    if(v === 'Community College') return `<span class="badge cc">COMMUNITY COLLEGE</span>`;
    if(v === 'University') return `<span class="badge univ">4‚ÄëYEAR UNIVERSITY</span>`;
    if(v === 'Private') return `<span class="badge priv">PRIVATE</span>`;
    return `<span class="badge">${safe(v)}</span>`;
  }
  function safe(s){ return String(s||'').replace(/[&<>]/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;'}[c])); }
  function safeAttr(s){ return String(s||'').replace(/"/g,'&quot;'); }

  // Excel export (matching your other pages‚Äô behavior; no libs)
  function exportToExcel(){
    // make a shallow clone of the visible table (so we don‚Äôt mutate UI)
    const table = document.getElementById('tbl').cloneNode(true);
    // remove Source buttons to keep it clean in Excel (turn into plain URLs if present)
    for(const td of table.querySelectorAll('td:last-child')){
      const a = td.querySelector('a'); if(a){ td.textContent = a.href; }
    }
    const html = `
      <html xmlns:o="urn:schemas-microsoft-com:office:office"
            xmlns:x="urn:schemas-microsoft-com:office:excel"
            xmlns="http://www.w3.org/TR/REC-html40">
      <head>
        <!--[if gte mso 9]><xml>
        <x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet>
        <x:Name>AMC Crosswalk</x:Name>
        <x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions>
        </x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook>
        </xml><![endif]-->
        <meta charset="utf-8" />
      </head>
      <body>${table.outerHTML}</body></html>`;
    const blob = new Blob([html], {type:'application/vnd.ms-excel'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'AMC_Crosswalk.xls';
    document.body.appendChild(a); a.click(); URL.revokeObjectURL(a.href); a.remove();
  }

  // CSV parsing
  function parseCSV(str){
    const rows=[]; let row=[]; let cell=''; let inQ=false;
    for(let i=0;i<str.length;i++){
      const ch=str[i], nx=str[i+1];
      if(inQ){
        if(ch === '"' && nx === '"'){ cell+='"'; i++; }
        else if(ch === '"'){ inQ=false; }
        else { cell+=ch; }
      }else{
        if(ch === '"'){ inQ=true; }
        else if(ch === ','){ row.push(cell); cell=''; }
        else if(ch === '\n'){ row.push(cell); rows.push(row); row=[]; cell=''; }
        else if(ch === '\r'){ /* ignore */ }
        else { cell+=ch; }
      }
    }
    if(cell.length || row.length){ row.push(cell); rows.push(row); }
    if(rows.length && rows[0].length){ rows[0][0]=rows[0][0].replace(/^\uFEFF/,''); }
    return rows.filter(r => r.some(c => String(c).trim().length));
  }
  function toObjects(rows){
    const header=rows[0]; const out=[];
    for(let i=1;i<rows.length;i++){
      const o={}; header.forEach((k,idx)=>{ o[k]=rows[i][idx] ?? ''; });
      out.push(o);
    }
    return out;
  }
})();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explore Careers & Training</title>
    <link rel="stylesheet" href="assets/common.css">
    <style>
        *{ box-sizing:border-box; }
        body{ font-family:'Montserrat','Calibri','Segoe UI',sans-serif; margin:0; background: linear-gradient(135deg,#BD0934 0%, #FFC838 100%); min-height:100vh; padding:20px; }
        .container{ max-width:1200px; margin:0 auto; background:#fff; border-radius:20px; padding:24px; box-shadow:0 20px 60px rgba(0,0,0,0.3); }
        h1{ text-align:center; margin:0 0 10px; font-size:2rem; background: linear-gradient(135deg,#BD0934,#FFC838); -webkit-background-clip:text; -webkit-text-fill-color:transparent; color:transparent; }
        p.lead{ text-align:center; color:#231F20; margin:0 0 16px; }

        .top-nav { display:flex; justify-content:center; align-items:center; gap:10px; position: sticky; top: 0; z-index: 300; margin-bottom: 14px; }
        .menu-toggle { display:none; border:1px solid #e2e8f0; background:#fff; border-radius:10px; padding:8px 12px; font-weight:700; cursor:pointer; }
        .quick-jump { display:flex; flex-wrap:wrap; gap:10px; background:#fff; border:1px solid #e2e8f0; border-radius:999px; padding:6px 10px; box-shadow:0 1px 4px rgba(0,0,0,0.06); }
        .quick-jump a { display:inline-block; padding:6px 10px; background:#231F20; color:#fff; text-decoration:none; border-radius:999px; font-size:0.9rem; transition:opacity .2s ease; }
        .quick-jump a:hover { opacity:.9; }
        .quick-jump a.active { background: linear-gradient(135deg, #BD0934, #FFC838); }
        @media (max-width: 900px){ .top-nav{ justify-content:space-between; } .menu-toggle{ display:inline-block; } .quick-jump{ display:none; border-radius:12px; gap:8px; padding:10px; flex-direction:column; align-items:flex-start; } .quick-jump.open{ display:flex; } .quick-jump a{ border-radius:8px; } }

        .controls{ display:grid; grid-template-columns: 2fr 1fr 1fr; gap:10px; align-items:end; }
        @media (max-width: 900px){ .controls{ grid-template-columns: 1fr; } }
        .field{ display:flex; flex-direction:column; gap:6px; }
        input[type="text"], select{ width:100%; padding:10px; border:1px solid #e2e8f0; border-radius:8px; }
        .chips{ display:flex; flex-wrap:wrap; gap:8px; }
        .chip{ display:inline-flex; align-items:center; gap:6px; padding:8px 12px; border-radius:999px; border:1px solid #e5e7eb; background:#fff; cursor:pointer; }
        .chip.active{ background:#111827; color:#fff; border-color:#111827; }
        .tabs{ display:flex; gap:8px; margin-top:12px; }
        .tab{ padding:8px 12px; border:1px solid #e5e7eb; border-radius:8px; background:#fff; cursor:pointer; }
        .tab.active{ background: linear-gradient(135deg,#BD0934,#FFC838); color:#fff; border-color:transparent; }
        .results{ margin-top:12px; display:grid; grid-template-columns: repeat(auto-fit,minmax(280px,1fr)); gap:12px; }
        .card{ background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:12px; display:flex; flex-direction:column; gap:6px; }
        .card h3{ margin:0; color:#111827; font-size:1.05rem; }
        .muted{ color:#64748b; font-size:0.95rem; }
        .tags{ display:flex; gap:6px; flex-wrap:wrap; }
        .tag{ display:inline-block; padding:4px 8px; border-radius:999px; border:1px solid #e5e7eb; font-size:0.8rem; color:#111827; background:#f9fafb; }
        .actions{ margin-top:auto; display:flex; gap:8px; }
        .btn{ padding:10px 14px; border-radius:10px; text-decoration:none; color:#fff; background: linear-gradient(135deg,#BD0934,#FFC838); font-weight:700; border:none; cursor:pointer; }
        .btn-outline{ background:#fff; color:#111827; border:1px solid #e2e8f0; }
        .toolbar{ display:flex; gap:8px; align-items:center; margin-top:8px; }
        details.adv { margin-top:8px; border:1px solid #e5e7eb; border-radius:10px; }
        details.adv > summary{ padding:8px 10px; cursor:pointer; font-weight:700; }
        details.adv > div{ padding: 8px 10px; display:grid; grid-template-columns: repeat(auto-fit,minmax(180px,1fr)); gap:10px; }
        .loading{ text-align:center; color:#64748b; padding:10px; }
        .compare-bar{ position: sticky; bottom: 10px; display:none; justify-content:space-between; align-items:center; background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:8px 10px; box-shadow:0 6px 18px rgba(0,0,0,0.08); margin-top:10px; }
        /* Modals */
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; padding: 20px; z-index: 1300; }
        .modal.open { display: flex; }
        .modal-content { background: #fff; border-radius: 12px; max-width: 720px; width: 100%; padding: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); border-left: 4px solid #BD0934; }
        .modal-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
        .modal-close { border:none; background:transparent; font-size:1.5rem; cursor:pointer; color:#231F20; }
    </style>
</head>
<body>
    <nav class="top-nav">
        <button class="menu-toggle" id="menuToggle" aria-label="Menu" aria-controls="site-menu" aria-expanded="false">Menu</button>
        <div class="quick-jump" id="site-menu">
            <a href="index.html">Home</a>
            <a href="assessments.html">Student Journey</a>
            <a href="portfolio.html">Portfolio</a>
            <a href="resume.html">Resume</a>
            <a href="dt-crosswalk-table.html">Digital Technology</a>
            <a href="003_ed_crosswalk-table.html">Education</a>
            <a href="enr-crosswalk-table.html">ENR</a>
            <a href="pss_crosswalk.html">PSS</a>
            <a href="explore.html" class="active">Explore</a>
        </div>
    </nav>
    <div class="container">
        <h1>Explore Careers & Training</h1>
        <p class="lead">Search occupations, nearby training, apprenticeships, and local help — then add items to your 6‑year plan.</p>

        <div class="controls">
            <div class="field">
                <label for="q">Keyword</label>
                <input id="q" type="text" placeholder="e.g., data, nurse, electrician">
            </div>
            <div class="field">
                <label>RIASEC</label>
                <div class="chips" id="riasecChips">
                    <button class="chip" data-code="R">R</button>
                    <button class="chip" data-code="I">I</button>
                    <button class="chip" data-code="A">A</button>
                    <button class="chip" data-code="S">S</button>
                    <button class="chip" data-code="E">E</button>
                    <button class="chip" data-code="C">C</button>
                </div>
            </div>
            <div class="field">
                <label for="jobZone">Job Zone</label>
                <select id="jobZone">
                    <option value="">Any</option>
                    <option value="1">1 — Little or no preparation</option>
                    <option value="2">2 — Some preparation</option>
                    <option value="3">3 — Medium preparation</option>
                    <option value="4">4 — Considerable preparation</option>
                    <option value="5">5 — Extensive preparation</option>
                </select>
            </div>
        </div>

        <div class="controls" style="margin-top:8px;">
            <div class="field">
                <label>Region (from Journey)</label>
                <input id="region" type="text" readonly>
            </div>
            <div class="field">
                <label>Radius (miles)</label>
                <input id="radius" type="text" readonly>
            </div>
            <div class="field">
                <label>ZIP (from Profile)</label>
                <input id="zip" type="text" readonly>
            </div>
        </div>

        <div class="tabs" role="tablist">
            <button class="tab active" data-tab="occupations">Occupations</button>
            <button class="tab" data-tab="training">Training</button>
            <button class="tab" data-tab="apprenticeships">Apprenticeships</button>
            <button class="tab" data-tab="local">Local Help</button>
        </div>
        <div class="toolbar">
            <button id="searchBtn" class="btn">Search</button>
            <button id="resetBtn" class="btn-outline">Reset Filters</button>
            <div class="muted">Region/ZIP come from Student Journey</div>
        </div>
        <details class="adv">
            <summary>Advanced filters</summary>
            <div>
                <div class="field"><label for="wageMin">Min Wage ($/hr)</label><input id="wageMin" type="text" inputmode="decimal" placeholder="e.g., 20"></div>
                <div class="field"><label for="edu">Min Job Zone</label>
                    <select id="edu"><option value="">Any</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select>
                </div>
            </div>
        </details>

        <div id="loading" class="loading" style="display:none;">Loading…</div>
        <div id="results" class="results" aria-live="polite"></div>
        <div id="noResults" class="loading" style="display:none;">No results found. Try adjusting filters or keywords.</div>
        <div id="compareBar" class="compare-bar"><div><strong>Compare:</strong> <span id="compareCount">0</span>/2 selected</div><div class="actions"><button id="compareBtn" class="btn-outline">Open Compare</button><button id="clearCompare" class="btn-outline">Clear</button></div></div>
    </div>

    <button id="feedbackFab" class="fab-pill" aria-label="Open feedback">Feedback</button>
    <div class="modal" id="modal-feedback" aria-hidden="true" role="dialog" aria-labelledby="feedbackTitle">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="feedbackTitle" style="color:#231F20;">Send Feedback</h2>
                <button class="modal-close" data-close aria-label="Close">×</button>
            </div>
            <p style="color:#334155;margin:0 0 8px;">Tell us what’s working and what to improve.</p>
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px;">
                <div><label style="display:block;color:#334155;font-size:0.95rem;">Name</label><input id="fbName" type="text" style="width:100%;padding:8px 10px;border:1px solid #e2e8f0;border-radius:8px;"></div>
                <div><label style="display:block;color:#334155;font-size:0.95rem;">Email</label><input id="fbEmail" type="email" style="width:100%;padding:8px 10px;border:1px solid #e2e8f0;border-radius:8px;"></div>
            </div>
            <div style="margin-top:10px;"><label style="display:block;color:#334155;font-size:0.95rem;">Message</label><textarea id="fbMessage" placeholder="Your feedback..." style="width:100%;min-height:120px;border:1px solid #e2e8f0;border-radius:8px;padding:10px;"></textarea></div>
            <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:10px;">
                <button id="copyFeedback" class="btn-outline">Copy</button>
                <button id="emailFeedback" class="btn">Email</button>
            </div>
        </div>
    </div>
    <script>
        // Mobile menu
        (function(){ const t=document.getElementById('menuToggle'); const m=document.getElementById('site-menu'); if(t&&m){ t.addEventListener('click', ()=>{ const o=m.classList.toggle('open'); t.setAttribute('aria-expanded', o?'true':'false'); }); } })();

        const API_BASE = (localStorage.getItem('apiBase') || '/api').replace(/\/$/, '');

        function getFilters(){
            const q = document.getElementById('q').value.trim();
            const ri = Array.from(document.querySelectorAll('#riasecChips .chip.active')).map(c=>c.getAttribute('data-code')).join('');
            const jobZone = document.getElementById('jobZone').value;
            const region = document.getElementById('region').value.trim();
            const radius = document.getElementById('radius').value.trim();
            const zip = document.getElementById('zip').value.trim();
            return { q, ri, jobZone, region, radius, zip };
        }

        function showLoading(on){ document.getElementById('loading').style.display = on?'block':'none'; }
        async function fetchJSON(url){
            try{ const res = await fetch(url, { headers: { 'Accept':'application/json' } }); if(!res.ok) throw new Error('Bad status'); return await res.json(); } catch(e){ return null; }
        }

        async function searchOccupations(){
            const { q, ri, jobZone, region, radius } = getFilters();
            const url = `${API_BASE}/v1/occupations/search?q=${encodeURIComponent(q)}&riasec=${encodeURIComponent(ri)}&job_zone=${encodeURIComponent(jobZone)}&region=${encodeURIComponent(region)}&radius=${encodeURIComponent(radius)}`;
            const data = await fetchJSON(url);
            if(data && Array.isArray(data.items)) return data.items;
            // Fallback demo data
            return [
                { soc:'15-1252.00', title:'Software Developers', summary:'Develop and maintain software applications.', riasec:'IC', job_zone:4, source:'demo' },
                { soc:'29-1141.00', title:'Registered Nurses', summary:'Provide and coordinate patient care.', riasec:'SIE', job_zone:4, source:'demo' }
            ];
        }

        async function searchTraining(){
            const { q, zip, radius } = getFilters();
            const url = `${API_BASE}/v1/training?keyword=${encodeURIComponent(q)}&zipcode=${encodeURIComponent(zip)}&radius=${encodeURIComponent(radius)}`;
            const data = await fetchJSON(url);
            if(data && Array.isArray(data.items)) return data.items;
            return [ { name:'Intro to Data Analytics', provider:'Community College', location:{city:'Local',state:'MD',zip}, url:'#', type:'Certificate' } ];
        }

        async function searchApprenticeships(){
            const { q, zip } = getFilters();
            const url = `${API_BASE}/v1/apprenticeships?keyword=${encodeURIComponent(q)}&location=${encodeURIComponent(zip)}`;
            const data = await fetchJSON(url);
            if(data && Array.isArray(data.items)) return data.items;
            return [ { name:'IT Support Apprentice', provider:'Employer ABC', location:{city:'Nearby',state:'MD',zip}, url:'#', type:'Apprenticeship' } ];
        }

        async function searchLocal(){
            const { zip } = getFilters();
            const url = `${API_BASE}/v1/local-help/ajc?zip=${encodeURIComponent(zip)}`;
            const data = await fetchJSON(url);
            if(data && Array.isArray(data.items)) return data.items;
            return [ { name:'American Job Center', location:{city:'Local',state:'MD',zip}, url:'https://www.careeronestop.org/LocalHelp/AmericanJobCenters/american-job-centers.aspx' } ];
        }

        function ensurePlan(){ try{ const m=JSON.parse(localStorage.getItem('studentPlanV1')||'[]'); if(Array.isArray(m) && m.length) return m; }catch{} return Array.from({length:6},(_,i)=>({year:i+1,items:[]})); }
        function savePlan(m){ localStorage.setItem('studentPlanV1', JSON.stringify(m)); }
        function addToPlan(text){ const m=ensurePlan(); let year = Number(prompt('Add to which year? (1-6)', '1'))||1; year=Math.max(1,Math.min(6,year)); const idx=year-1; m[idx].items.push(text); savePlan(m); alert(`Added to Year ${year} of your plan`); }

        const compareSel = new Set();
        function toggleCompare(key){ if(compareSel.has(key)) compareSel.delete(key); else if(compareSel.size<2) compareSel.add(key); updateCompareBar(); }
        function updateCompareBar(){ const bar=document.getElementById('compareBar'); const n=compareSel.size; document.getElementById('compareCount').textContent=String(n); bar.style.display = n>0 ? 'flex' : 'none'; }
        async function openCompare(){ if(compareSel.size!==2){ alert('Select 2 occupations to compare.'); return; } const [a,b]=Array.from(compareSel); const ad=await getOccupationDetail(a); const bd=await getOccupationDetail(b); showCompareModal(ad, bd); }

        function render(items, kind){
            const root = document.getElementById('results'); root.innerHTML='';
            const empty = document.getElementById('noResults'); empty.style.display='none';
            if(!items || !items.length){ empty.style.display='block'; return; }
            items.forEach(it =>{
                const card=document.createElement('div'); card.className='card';
                const h=document.createElement('h3'); h.textContent = it.title || it.name || it.soc || 'Result'; card.appendChild(h);
                const sub=document.createElement('div'); sub.className='muted';
                if(kind==='occupations') sub.textContent = it.summary || '';
                if(kind==='training') sub.textContent = `${it.provider||''} • ${(it.location&&[it.location.city,it.location.state].filter(Boolean).join(', '))||''}`;
                if(kind==='apprenticeships') sub.textContent = `${it.provider||''} • ${(it.location&&[it.location.city,it.location.state].filter(Boolean).join(', '))||''}`;
                if(kind==='local') sub.textContent = (it.location&&[it.location.city,it.location.state,it.location.zip].filter(Boolean).join(', '))||'';
                card.appendChild(sub);
                if(kind==='occupations'){
                    const tags=document.createElement('div'); tags.className='tags';
                    if (it.riasec) tags.appendChild(tag(`RIASEC: ${it.riasec}`));
                    if (it.job_zone) tags.appendChild(tag(`Job Zone: ${it.job_zone}`));
                    card.appendChild(tags);
                }
                const actions=document.createElement('div'); actions.className='actions';
                if(kind==='occupations'){
                    const details=document.createElement('button'); details.className='btn-outline'; details.textContent='Details'; details.onclick=()=> openDetails(it);
                    const compare=document.createElement('button'); compare.className='btn-outline'; compare.textContent = 'Compare'; compare.onclick=()=> toggleCompare(it.soc||it.title||h.textContent);
                    actions.appendChild(details); actions.appendChild(compare);
                }
                const plan=document.createElement('button'); plan.className='btn'; plan.textContent='Add to Plan'; plan.onclick=()=> addToPlan(h.textContent);
                const open=document.createElement('a'); open.className='btn-outline'; open.textContent='Open Source'; open.href=it.url||'#'; open.target='_blank'; open.rel='noopener';
                actions.appendChild(plan); actions.appendChild(open); card.appendChild(actions);
                root.appendChild(card);
            });
        }

        async function run(kind){
            showLoading(true);
            if(kind==='occupations') render(await searchOccupations(), kind);
            if(kind==='training') render(await searchTraining(), kind);
            if(kind==='apprenticeships') render(await searchApprenticeships(), kind);
            if(kind==='local') render(await searchLocal(), kind);
            showLoading(false);
        }

        // Wire
        document.getElementById('riasecChips').addEventListener('click', (e)=>{ const b=e.target.closest('.chip'); if(!b) return; b.classList.toggle('active'); });
        document.querySelectorAll('.tab').forEach(t=> t.addEventListener('click', ()=>{ document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active')); t.classList.add('active'); run(t.getAttribute('data-tab')); }));
        document.getElementById('q').addEventListener('keydown', e=>{ if(e.key==='Enter'){ const tab=document.querySelector('.tab.active').getAttribute('data-tab'); run(tab); }});
        document.getElementById('searchBtn').addEventListener('click', ()=>{ const tab=document.querySelector('.tab.active').getAttribute('data-tab'); run(tab); });
        document.getElementById('resetBtn').addEventListener('click', ()=>{ document.getElementById('q').value=''; document.querySelectorAll('#riasecChips .chip').forEach(c=>c.classList.remove('active')); document.getElementById('jobZone').value=''; document.getElementById('wageMin').value=''; document.getElementById('edu').value=''; const tab=document.querySelector('.tab.active').getAttribute('data-tab'); run(tab); });
        document.getElementById('compareBtn').addEventListener('click', openCompare);
        document.getElementById('clearCompare').addEventListener('click', ()=>{ compareSel.clear(); updateCompareBar(); });

        // Prefill region/zip from Journey and preselect RIASEC chips
        (function(){
            try{ const r=JSON.parse(localStorage.getItem('regionSettingsV1')||'{}'); document.getElementById('region').value=r.region||''; document.getElementById('radius').value=r.radius||''; }catch{}
            try{ const p=JSON.parse(localStorage.getItem('studentProfileV1')||'{}'); document.getElementById('zip').value=p.zip||''; }catch{}
            try{ const a=JSON.parse(localStorage.getItem('studentAssessmentsV1')||'{}'); const top=(a.riasec&&a.riasec.top)||''; top.split('').forEach(c=>{ const el=document.querySelector(`#riasecChips .chip[data-code="${c}"]`); if(el) el.classList.add('active'); }); }catch{}
        })();
        // Initial load
        run('occupations');

        // Helpers
        function tag(text){ const s=document.createElement('span'); s.className='tag'; s.textContent=text; return s; }

        async function getOccupationDetail(key){
            // key is soc or title
            const soc = (String(key).match(/\d{2}-\d{4}\.\d{2}/) || [])[0] || '';
            if (soc){
                const url = `${API_BASE}/v1/occupations/${encodeURIComponent(soc)}`;
                const data = await fetchJSON(url);
                if (data) return data;
            }
            // Fallback demo details
            if ((key||'').includes('15-1252') || (key||'').includes('Software')) return { soc:'15-1252.00', title:'Software Developers', description:'Develop and maintain software applications and systems.', riasec:'IC', job_zone:4, tasks:['Design, develop, and test software','Collaborate with cross-functional teams'], skills:{Programming:'High',ProblemSolving:'High'} };
            if ((key||'').includes('29-1141') || (key||'').includes('Nurse')) return { soc:'29-1141.00', title:'Registered Nurses', description:'Provide and coordinate patient care; educate patients.', riasec:'SIE', job_zone:4, tasks:['Assess patient health problems','Develop and implement nursing care plans'], skills:{PatientCare:'High',Communication:'High'} };
            return { title:String(key), description:'Details not available in demo.' };
        }

        function openDetails(it){
            showDetailModal({ title: it.title||it.name||it.soc, summary: it.summary||'', riasec: it.riasec||'', job_zone: it.job_zone||'', soc: it.soc||'' });
        }
    </script>

    <!-- Detail Modal -->
    <div class="modal" id="modal-detail" aria-hidden="true" role="dialog" aria-labelledby="detailTitle">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="detailTitle" style="color:#231F20;">Occupation Details</h2>
                <button class="modal-close" data-close aria-label="Close">×</button>
            </div>
            <div id="detailBody" class="muted">Loading…</div>
        </div>
    </div>

    <!-- Compare Modal -->
    <div class="modal" id="modal-compare" aria-hidden="true" role="dialog" aria-labelledby="compareTitle">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="compareTitle" style="color:#231F20;">Compare Occupations</h2>
                <button class="modal-close" data-close aria-label="Close">×</button>
            </div>
            <div id="compareBody" class="muted">Loading…</div>
        </div>
    </div>

    <script>
        // Modal helpers for details/compare
        (function(){
            const dModal=document.getElementById('modal-detail');
            const cModal=document.getElementById('modal-compare');
            function close(m){ m.classList.remove('open'); m.setAttribute('aria-hidden','true'); }
            dModal.addEventListener('click', (e)=>{ if(e.target===dModal || e.target.hasAttribute('data-close')) close(dModal); });
            cModal.addEventListener('click', (e)=>{ if(e.target===cModal || e.target.hasAttribute('data-close')) close(cModal); });
            window.showDetailModal = async function(meta){ dModal.classList.add('open'); dModal.setAttribute('aria-hidden','false'); const body=document.getElementById('detailBody'); body.textContent='Loading…'; const det=await getOccupationDetail(meta.soc||meta.title); const html = `
                <div><strong>${det.title||meta.title}</strong> ${det.soc?`<span class="tag">${det.soc}</span>`:''}</div>
                <div class="muted" style="margin:6px 0;">${det.description||meta.summary||''}</div>
                <div class="tags">${det.riasec?`<span class="tag">RIASEC: ${det.riasec}</span>`:''}${det.job_zone?`<span class="tag">Job Zone: ${det.job_zone}</span>`:''}</div>
                ${Array.isArray(det.tasks)?`<div style="margin-top:8px;"><strong>Common tasks</strong><ul style="margin-left:18px;">${det.tasks.slice(0,5).map(t=>`<li>${t}</li>`).join('')}</ul></div>`:''}
            `; body.innerHTML = html; };
            window.showCompareModal = function(a,b){ cModal.classList.add('open'); cModal.setAttribute('aria-hidden','false'); const body=document.getElementById('compareBody'); body.innerHTML = `
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                    <div><strong>${a.title||''}</strong>${a.soc?` <span class='tag'>${a.soc}</span>`:''}<div class='muted'>${a.description||''}</div><div class='tags'>${a.riasec?`<span class='tag'>RIASEC: ${a.riasec}</span>`:''}${a.job_zone?`<span class='tag'>Job Zone: ${a.job_zone}</span>`:''}</div></div>
                    <div><strong>${b.title||''}</strong>${b.soc?` <span class='tag'>${b.soc}</span>`:''}<div class='muted'>${b.description||''}</div><div class='tags'>${b.riasec?`<span class='tag'>RIASEC: ${b.riasec}</span>`:''}${b.job_zone?`<span class='tag'>Job Zone: ${b.job_zone}</span>`:''}</div></div>
                </div>`; };
        })();
    </script>
    <script>
        // Feedback modal wiring
        (function(){
            const fab = document.getElementById('feedbackFab');
            const modal = document.getElementById('modal-feedback');
            function open(){ modal.classList.add('open'); modal.setAttribute('aria-hidden','false'); }
            function close(){ modal.classList.remove('open'); modal.setAttribute('aria-hidden','true'); }
            fab.addEventListener('click', open);
            modal.addEventListener('click', (e)=>{ if (e.target===modal || e.target.hasAttribute('data-close')) close(); });
            function buildFeedbackText(){ const name=(document.getElementById('fbName')?.value||'').trim(); const email=(document.getElementById('fbEmail')?.value||'').trim(); const msg=(document.getElementById('fbMessage')?.value||'').trim(); const page=`${document.title} (${location.href})`; return `Name: ${name}\nEmail: ${email}\nPage: ${page}\n\nMessage:\n${msg}`.trim(); }
            document.getElementById('copyFeedback').addEventListener('click', async ()=>{ const txt=buildFeedbackText(); try{ await navigator.clipboard.writeText(txt); alert('Copied to clipboard.'); }catch{} });
            document.getElementById('emailFeedback').addEventListener('click', ()=>{ const subj=encodeURIComponent('CTE Tools Feedback (Explore)'); const body=encodeURIComponent(buildFeedbackText()); window.location.href=`mailto:occpcteprograms.msde@maryland.gov?subject=${subj}&body=${body}`; });
        })();
    </script>
</body>
</html>

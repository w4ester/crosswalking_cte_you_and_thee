<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Robust drop prevention (capture-level) -->
    <script>(function(){function block(e){e.preventDefault();e.stopPropagation();}window.addEventListener('dragover',block,{capture:true});window.addEventListener('drop',block,{capture:true});document.addEventListener('dragover',block,{capture:true});document.addEventListener('drop',block,{capture:true});})();</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Technology Cluster Crosswalk Analysis</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', 'Calibri', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #BD0934 0%, #FFC838 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.97);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #231F20;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-align: center;
            background: linear-gradient(135deg, #BD0934, #FFC838);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            text-align: center;
            color: #231F20;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .program-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .program-btn {
            padding: 12px 20px;
            border: 2px solid #BD0934;
            background: white;
            color: #BD0934;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .program-btn:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #BD0934, #FFC838);
            transition: left 0.3s;
            z-index: -1;
        }

        .program-btn:hover:before,
        .program-btn.active:before {
            left: 0;
        }

        .program-btn:hover,
        .program-btn.active {
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(189, 9, 52, 0.3);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(135deg, #BD0934, #FFC838);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            color: #231F20;
            margin-top: 5px;
            font-size: 0.9rem;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 12px 40px 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: #BD0934;
            box-shadow: 0 0 0 3px rgba(189, 9, 52, 0.1);
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #a0aec0;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #BD0934, #FFC838);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(189, 9, 52, 0.3);
        }

        .btn-secondary {
            background: #48bb78;
            color: white;
        }

        .btn-secondary:hover {
            background: #38a169;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(72, 187, 120, 0.3);
        }

        /* Top cluster nav */
        .top-nav { display:flex; justify-content:center; position: sticky; top: 0; z-index: 300; margin-bottom: 10px; }
        .quick-jump { display:flex; flex-wrap:wrap; gap:10px; background:#fff; border:1px solid #e2e8f0; border-radius:999px; padding:6px 10px; box-shadow:0 1px 4px rgba(0,0,0,0.06); }
        .quick-jump a { display:inline-block; padding:6px 10px; background:#231F20; color:#fff; text-decoration:none; border-radius:999px; font-size:0.9rem; transition:opacity .2s ease; }
        .quick-jump a:hover { opacity:.9; }
        .quick-jump a.active { background: linear-gradient(135deg, #BD0934, #FFC838); }

        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
            margin-bottom: 30px;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            background: white;
        }

        thead {
            background: linear-gradient(135deg, #BD0934, #FFC838);
            color: white;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
            white-space: nowrap;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        tbody tr {
            transition: all 0.3s;
        }

        tbody tr:hover {
            background: #E2E3E4;
            transform: scale(1.01);
        }

        .institution-type {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .type-community {
            background: #bee3f8;
            color: #2c5282;
        }

        .type-university {
            background: #c6f6d5;
            color: #22543d;
        }

        .program-type {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 5px;
        }

        .type-programming {
            background: #faf5ff;
            color: #553c9a;
        }

        .type-cybersecurity {
            background: #fee2e2;
            color: #991b1b;
        }

        .type-ml {
            background: #fef3c7;
            color: #92400e;
        }

        .type-networking {
            background: #dbeafe;
            color: #1e40af;
        }

        .credential-badge {
            display: inline-block;
            padding: 3px 8px;
            margin: 2px;
            border-radius: 5px;
            font-size: 0.85rem;
            background: #f0f4f8;
            color: #231F20;
            border: 1px solid #cbd5e0;
        }

        .certificate-tag {
            display: inline-block;
            padding: 3px 8px;
            margin: 2px;
            border-radius: 5px;
            font-size: 0.85rem;
            background: #fed7d7;
            color: #742a2a;
            font-weight: 600;
        }

        .info-box {
            background: #edf2f7;
            border-left: 4px solid #BD0934;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .info-box h3 {
            color: #231F20;
            margin-bottom: 10px;
        }

        .info-box ul {
            margin-left: 20px;
            color: #4a5568;
        }

        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .designation-badge {
            display: inline-block;
            padding: 2px 6px;
            margin-left: 5px;
            border-radius: 3px;
            font-size: 0.75rem;
            background: #805ad5;
            color: white;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 1.8rem;
            }

            .controls {
                flex-direction: column;
            }

            .search-box {
                width: 100%;
            }

            .btn-group {
                width: 100%;
                justify-content: stretch;
            }

            button {
                flex: 1;
            }

            .program-selector {
                flex-direction: column;
            }

            .program-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <nav class="top-nav">
        <div class="quick-jump">
            <a href="index.html">Home</a>
            <a href="dt-crosswalk-table.html" class="active">Digital Technology</a>
            <a href="003_ed_crosswalk-table.html">Education</a>
            <a href="enr-crosswalk-table.html">ENR General</a>
            <a href="003_table_enr_renewable_energy_crosswalk_table.html">ENR Renewable</a>
            <a href="pss_crosswalk.html">PSS</a>
        </div>
    </nav>
    <div class="container">
        <h1>Digital Technology Cluster Crosswalk Analysis</h1>
        <div style="text-align:center; margin-bottom: 10px; color:#231F20; font-size:0.95rem;">
            <a href="index.html">Home</a> &gt; Digital Technology
        </div>
        <p class="subtitle">Maryland Educational Programs & Industry Credentials</p>

        <div class="program-selector">
            <button class="program-btn active" onclick="selectProgram('all')">All Programs</button>
            <button class="program-btn" onclick="selectProgram('programming')">Computer Programming I</button>
            <button class="program-btn" onclick="selectProgram('cybersecurity')">Cybersecurity</button>
            <button class="program-btn" onclick="selectProgram('ml')">Machine Learning & Data Science</button>
            <button class="program-btn" onclick="selectProgram('networking')">Networking</button>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalPrograms">0</div>
                <div class="stat-label">Total Programs</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="communityColleges">0</div>
                <div class="stat-label">Community Colleges</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="universities">0</div>
                <div class="stat-label">Universities</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="certificatePrograms">0</div>
                <div class="stat-label">Certificate Programs</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="nsaDesignated">0</div>
                <div class="stat-label">NSA/DHS Designated</div>
            </div>
        </div>

        <div class="controls">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search programs, institutions, or credentials...">
                <span class="search-icon">üîç</span>
            </div>
            <div class="btn-group">
                <button class="btn-secondary" onclick="filterTable('all')">Show All</button>
                <button class="btn-secondary" onclick="filterTable('community')">Community Colleges</button>
                <button class="btn-secondary" onclick="filterTable('university')">Universities</button>
                <button class="btn-primary" onclick="exportToExcel()">üìä Export to Excel</button>
            </div>
        </div>

        <div class="legend">
            <div class="legend-item">
                <span class="program-type type-programming">PROG</span>
                <span>Programming</span>
            </div>
            <div class="legend-item">
                <span class="program-type type-cybersecurity">CYBER</span>
                <span>Cybersecurity</span>
            </div>
            <div class="legend-item">
                <span class="program-type type-ml">ML/DS</span>
                <span>Machine Learning</span>
            </div>
            <div class="legend-item">
                <span class="program-type type-networking">NET</span>
                <span>Networking</span>
            </div>
        </div>

        <div class="info-box">
            <h3>üéì Key Industry Credentials by Program</h3>
            <ul>
                <li><strong>Programming:</strong> IT Specialist: Python, PCEP (Python Entry-Level)</li>
                <li><strong>Cybersecurity:</strong> CompTIA A+, Network+, Security+, CySA+</li>
                <li><strong>ML & Data Science:</strong> IBM Data Science, Google Data Analytics, Azure Data Scientist, CompTIA Data+, AWS-SA</li>
                <li><strong>Networking:</strong> CompTIA A+, Network+, Security+, Cisco RSTECH, CCNA</li>
            </ul>
        </div>

        <div class="table-container">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th>Program Area</th>
                        <th>Institution</th>
                        <th>Type</th>
                        <th>Degrees/Programs</th>
                        <th>Certificates</th>
                        <th>Key Features</th>
                        <th>Industry Credentials Aligned</th>
                        <th>Source</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- Table content will be populated by JavaScript -->
                </tbody>
            </table>
        
    <!-- Chat launcher and panel (client-only, page-scoped) -->
    <button id="chatLauncher" aria-label="Open AI chat" style="position:fixed;right:20px;bottom:20px;background:linear-gradient(135deg,#BD0934,#FFC838);color:#fff;border:none;border-radius:999px;padding:12px 16px;font-weight:700;box-shadow:0 8px 24px rgba(0,0,0,0.2);cursor:pointer;z-index:500;">Chat</button>
    <div id="chatPanel" style="position:fixed;right:20px;bottom:80px;width:360px;max-width:92vw;background:#fff;border:1px solid #e2e8f0;border-radius:12px;box-shadow:0 12px 40px rgba(0,0,0,0.25);display:none;flex-direction:column;overflow:hidden;z-index:500;">
        <div style="display:flex;align-items:center;justify-content:space-between;padding:10px 12px;background:#E2E3E4;border-bottom:1px solid #e2e8f0;">
            <strong style="color:#231F20;">Ask about Digital Technology</strong>
            <button id="chatClose" aria-label="Close chat" style="background:transparent;border:none;font-size:18px;color:#231F20;cursor:pointer;">√ó</button>
        </div>
        <div id="chatMsgs" style="padding:12px;display:flex;flex-direction:column;gap:10px;max-height:45vh;overflow:auto;">
            <div style="background:#f7fafc;border:1px solid #e2e8f0;border-radius:8px;padding:8px 10px;color:#231F20;">Hi! Ask me about DT programs, credentials, or institutions. Try: "Programming certificates at community colleges"</div>
        </div>
        <div style="padding:8px;border-top:1px solid #e2e8f0;display:flex;gap:8px;">
            <input id="chatInput" type="text" placeholder="Ask about programs, credentials..." style="flex:1;padding:10px;border:1px solid #e2e8f0;border-radius:8px;">
            <button id="chatSend" style="background:linear-gradient(135deg,#BD0934,#FFC838);color:#fff;border:none;border-radius:8px;padding:10px 12px;cursor:pointer;">Send</button>
        </div>
        <div style="padding:8px;display:flex;flex-wrap:wrap;gap:6px;border-top:1px solid #f1f5f9;">
            <button class="chat-suggest" data-q="2-year with certificates" style="border:1px solid #e2e8f0;background:#fff;border-radius:999px;padding:6px 10px;cursor:pointer;">2-year with certificates</button>
            <button class="chat-suggest" data-q="Programming credentials" style="border:1px solid #e2e8f0;background:#fff;border-radius:999px;padding:6px 10px;cursor:pointer;">Programming credentials</button>
            <button class="chat-suggest" data-q="Cybersecurity at universities" style="border:1px solid #e2e8f0;background:#fff;border-radius:999px;padding:6px 10px;cursor:pointer;">Cybersecurity at universities</button>
        </div>
    </div>

    <script>

        // Lightweight page-scoped retrieval and chat UI
        function dtBuildRecords() {
            const rows = document.querySelectorAll('#tableBody tr');
            const recs = [];
            rows.forEach((tr, idx) => {
                const tds = tr.querySelectorAll('td');
                if (tds.length < 7) return;
                recs.push({ idx,
                    programArea: tds[0].textContent.trim(),
                    institution: tds[1].textContent.trim(),
                    type: tds[2].textContent.trim(),
                    programs: tds[3].textContent.trim(),
                    certificates: tds[4].textContent.trim(),
                    features: tds[5].textContent.trim(),
                    credentials: tds[6].textContent.trim()
                });
            });
            return recs;
        }
        function dtSearchRecords(recs, query) {
            const q = query.trim().toLowerCase();
            if (!q) return [];
            const tokens = q.split(/\s+/).filter(Boolean);
            const want2 = /(2[-\s]?year|community)/.test(q);
            const want4 = /(4[-\s]?year|university|universities)/.test(q);
            const filtered = recs.filter(r => {
                if (want2 && !/community/i.test(r.type)) return false;
                if (want4 && !/university/i.test(r.type)) return false;
                return true;
            });
            const scored = filtered.map(r => {
                const text = { institution:r.institution.toLowerCase(), programArea:r.programArea.toLowerCase(),
                    programs:r.programs.toLowerCase(), certificates:r.certificates.toLowerCase(),
                    credentials:r.credentials.toLowerCase(), features:r.features.toLowerCase(), type:r.type.toLowerCase() };
                let score=0; tokens.forEach(t=>{
                    score += (text.institution.includes(t)?2:0)+(text.programArea.includes(t)?2:0)+(text.programs.includes(t)?2:0)+(text.certificates.includes(t)?2:0)+(text.credentials.includes(t)?3:0)+(text.features.includes(t)?1:0)+(text.type.includes(t)?2:0);
                });
                return {r, score};
            }).filter(x=>x.score>0).sort((a,b)=>b.score-a.score).slice(0,5).map(x=>x.r);
            return scored;
        }
        function dtAppendMsg(text, isUser) {
            const box = document.getElementById('chatMsgs');
            const div = document.createElement('div');
            div.style.border='1px solid #e2e8f0'; div.style.borderRadius='8px'; div.style.padding='8px 10px';
            div.style.background = isUser? '#fff':'#f7fafc'; div.style.color='#231F20'; div.textContent=text;
            box.appendChild(div); box.scrollTop=box.scrollHeight;
        }
        function dtAppendResults(results) {
            const box = document.getElementById('chatMsgs');
            if (!results.length) { dtAppendMsg('No direct match. Try specific keywords like "programming", "cybersecurity", or "university".', false); return; }
            const wrap=document.createElement('div'); wrap.style.display='flex'; wrap.style.flexDirection='column'; wrap.style.gap='8px';
            results.forEach(r=>{
                const card=document.createElement('div'); card.style.border='1px solid #e2e8f0'; card.style.borderRadius='8px'; card.style.padding='8px 10px';
                card.innerHTML = `<strong>${r.institution}</strong> ‚Äî ${r.programArea}<br><span style="color:#231F20">Type:</span> ${r.type} ¬∑ <span style="color:#231F20">Program:</span> ${r.programs}<br><span style="color:#231F20">Certs:</span> ${r.certificates||'-'} ¬∑ <span style="color:#231F20">Creds:</span> ${r.credentials||'-'}`;
                const btn=document.createElement('button'); btn.textContent='Open matching rows'; btn.style.marginTop='6px'; btn.style.background='linear-gradient(135deg,#BD0934,#FFC838)'; btn.style.color='#fff'; btn.style.border='none'; btn.style.borderRadius='6px'; btn.style.padding='6px 10px'; btn.style.cursor='pointer';
                btn.addEventListener('click',()=>{ const q=[r.institution,r.programArea].filter(Boolean).join(' '); const si=document.getElementById('searchInput'); if(si){ si.value=q; si.dispatchEvent(new Event('keyup')); document.getElementById('dataTable')?.scrollIntoView({behavior:'smooth'});} });
                card.appendChild(btn); wrap.appendChild(card);
            }); box.appendChild(wrap); box.scrollTop=box.scrollHeight;
        }
        (function dtChatInit(){
            const recs = dtBuildRecords();
            const open=document.getElementById('chatLauncher'); const panel=document.getElementById('chatPanel'); const closeBtn=document.getElementById('chatClose');
            const sendBtn=document.getElementById('chatSend'); const input=document.getElementById('chatInput');
            open.addEventListener('click',()=>{ panel.style.display='flex'; }); closeBtn.addEventListener('click',()=>{ panel.style.display='none'; });
            function handle(q){ dtAppendMsg(q,true); const rs=dtSearchRecords(recs,q.toLowerCase()); dtAppendResults(rs);} 
            sendBtn.addEventListener('click',()=>{ const q=input.value; if(q.trim()){ input.value=''; handle(q);} });
            input.addEventListener('keydown',(e)=>{ if(e.key==='Enter'){ e.preventDefault(); sendBtn.click(); }});
            document.querySelectorAll('.chat-suggest').forEach(b=> b.addEventListener('click', ()=> handle(b.getAttribute('data-q')) ));
        })();
        const programData = [
            // Computer Programming I - Community Colleges
            {
                programArea: "PROG",
                institution: "Montgomery College (MC)",
                type: "Community College",
                programs: "Computer Programming Certificate",
                certificates: "Python Programming (CMSC 206), Career Certificate",
                features: "Python fundamentals, variables, data types, control structures, functions, I/O operations",
                credentials: "IT Specialist: Python",
                nsaDesignated: false
            },
            {
                programArea: "PROG",
                institution: "Community College of Baltimore County (CCBC)",
                type: "Community College",
                programs: "Python Developer, Continuing Education",
                certificates: "Workforce Certificate",
                features: "Introductory through advanced Python including NumPy, pandas, matplotlib libraries",
                credentials: "IT Specialist: Python",
                nsaDesignated: false
            },
            {
                programArea: "PROG",
                institution: "Carroll Community College",
                type: "Community College",
                programs: "Computer Programming Certificate",
                certificates: "Career Certificate",
                features: "Python, C++, and Java with focus on problem solving and algorithm development",
                credentials: "IT Specialist: Python",
                nsaDesignated: false
            },
            {
                programArea: "PROG",
                institution: "Anne Arundel Community College (AACC)",
                type: "Community College",
                programs: "Computer Science, A.S.",
                certificates: "Python Programming courses (credit/noncredit)",
                features: "Python using fundamental design principles, data structures, security applications",
                credentials: "IT Specialist: Python",
                nsaDesignated: false
            },
            {
                programArea: "PROG",
                institution: "Prince George's Community College (PGCC)",
                type: "Community College",
                programs: "Computer Programming Certificate, Computer Science, A.S.",
                certificates: "Career Certificate",
                features: "Theoretical and practical background in Java, C++, and Python",
                credentials: "IT Specialist: Python",
                nsaDesignated: false
            },
            {
                programArea: "PROG",
                institution: "College of Southern Maryland (CSM)",
                type: "Community College",
                programs: "Computer Science, A.S.",
                certificates: "",
                features: "Solid theoretical and mathematical foundation with programming and data structures",
                credentials: "IT Specialist: Python",
                nsaDesignated: false
            },
            {
                programArea: "PROG",
                institution: "Harford Community College",
                type: "Community College",
                programs: "Computer Science, A.S.; Programming, CIS Certificate",
                certificates: "Python Certificate",
                features: "PCEP‚Ñ¢ Certified Entry-Level Python Programmer preparation",
                credentials: "IT Specialist: Python, PCEP",
                nsaDesignated: false
            },
            {
                programArea: "PROG",
                institution: "Frederick Community College (FCC)",
                type: "Community College",
                programs: "Game Programming Certificate; Computer Studies",
                certificates: "Coding & Programming continuing education",
                features: "Python with game development applications",
                credentials: "IT Specialist: Python",
                nsaDesignated: false
            },
            {
                programArea: "PROG",
                institution: "Howard Community College (HCC)",
                type: "Community College",
                programs: "Computer Science, A.A. (Transfer)",
                certificates: "Programming continuing education",
                features: "Java, C++, Python, JavaScript with strong transfer preparation",
                credentials: "IT Specialist: Python",
                nsaDesignated: false
            },
            {
                programArea: "PROG",
                institution: "Garrett College",
                type: "Community College",
                programs: "Computer Science, A.S.",
                certificates: "",
                features: "Programming Logic and Computer Science Programming I & II",
                credentials: "IT Specialist: Python",
                nsaDesignated: false
            },
            {
                programArea: "PROG",
                institution: "Baltimore City Community College (BCCC)",
                type: "Community College",
                programs: "Computer Information Systems; Computer Science transfer",
                certificates: "",
                features: "Practical programming experience with application development emphasis",
                credentials: "IT Specialist: Python",
                nsaDesignated: false
            },
            // Computer Programming I - Universities
            {
                programArea: "PROG",
                institution: "University of Maryland, College Park (UMD)",
                type: "University",
                programs: "Computer Science, B.S.",
                certificates: "",
                features: "CMSC131/132 using Java, Python courses including GEOG 276 Python programming",
                credentials: "IT Specialist: Python",
                nsaDesignated: false
            },
            {
                programArea: "PROG",
                institution: "University of Maryland, Baltimore County (UMBC)",
                type: "University",
                programs: "Computer Science, B.S. (ABET-accredited)",
                certificates: "",
                features: "CMSC 201 uses Python, comprehensive foundation with multiple tracks",
                credentials: "IT Specialist: Python",
                nsaDesignated: true
            },
            {
                programArea: "PROG",
                institution: "Towson University",
                type: "University",
                programs: "Computer Science, B.S. (ABET-accredited); CS with Software Engineering track",
                certificates: "",
                features: "Advanced programming including Python (COSC 395), software development",
                credentials: "IT Specialist: Python",
                nsaDesignated: true
            },
            // Cybersecurity - Community Colleges
            {
                programArea: "CYBER",
                institution: "Montgomery College (MC)",
                type: "Community College",
                programs: "Cybersecurity, A.A.S.",
                certificates: "Network Security, Computer Forensics",
                features: "NSTISSI 4011/4013 standards, CompTIA A+, Network+, Security+, CCNA preparation",
                credentials: "CompTIA A+, Network+, Security+, CCNA",
                nsaDesignated: false
            },
            {
                programArea: "CYBER",
                institution: "College of Southern Maryland (CSM)",
                type: "Community College",
                programs: "Cybersecurity, A.A.S.",
                certificates: "Cybersecurity Certificate",
                features: "CompTIA A+, Security+, Linux+, CCNA, CEH preparation with hands-on labs",
                credentials: "CompTIA A+, Security+, Linux+, CCNA, CEH",
                nsaDesignated: false
            },
            {
                programArea: "CYBER",
                institution: "Community College of Baltimore County (CCBC)",
                type: "Community College",
                programs: "Cybersecurity, A.A.S.",
                certificates: "Cybersecurity Certificate",
                features: "CompTIA-aligned coursework with network security and incident response",
                credentials: "CompTIA Security+",
                nsaDesignated: false
            },
            {
                programArea: "CYBER",
                institution: "Carroll Community College",
                type: "Community College",
                programs: "Cybersecurity, A.A.S.",
                certificates: "Cybersecurity Certificate",
                features: "State-of-the-art cybersecurity lab, network defense and security protocols",
                credentials: "CompTIA Network+, Security+",
                nsaDesignated: false
            },
            {
                programArea: "CYBER",
                institution: "Anne Arundel Community College (AACC)",
                type: "Community College",
                programs: "Cybersecurity, A.A.S.",
                certificates: "Network Security, Computer Forensics",
                features: "Network defense, digital forensics, security fundamentals",
                credentials: "CompTIA A+, Network+, Security+",
                nsaDesignated: false
            },
            {
                programArea: "CYBER",
                institution: "Prince George's Community College (PGCC)",
                type: "Community College",
                programs: "Information Security, A.A.S.",
                certificates: "Cybersecurity Certificate",
                features: "CompTIA Security+ preparation and network security fundamentals",
                credentials: "CompTIA Security+",
                nsaDesignated: false
            },
            {
                programArea: "CYBER",
                institution: "Harford Community College",
                type: "Community College",
                programs: "Cybersecurity, A.A.S.",
                certificates: "Cybersecurity Certificate",
                features: "Industry certification preparation with security fundamentals",
                credentials: "CompTIA certifications",
                nsaDesignated: false
            },
            {
                programArea: "CYBER",
                institution: "Hagerstown Community College",
                type: "Community College",
                programs: "Information Systems Technology, A.A.S.",
                certificates: "Web/Multimedia Development Certificate",
                features: "Network security basics and secure coding practices",
                credentials: "CompTIA fundamentals",
                nsaDesignated: false
            },
            {
                programArea: "CYBER",
                institution: "Howard Community College (HCC)",
                type: "Community College",
                programs: "Computer Science, A.A. with Cybersecurity pathway",
                certificates: "Security coursework",
                features: "Network security basics and security protocol implementation",
                credentials: "CompTIA Network+ fundamentals",
                nsaDesignated: false
            },
            {
                programArea: "CYBER",
                institution: "Frederick Community College (FCC)",
                type: "Community College",
                programs: "Information Technology, A.A.S.",
                certificates: "Cybersecurity Certificate",
                features: "Security fundamentals and network defense with certification prep",
                credentials: "CompTIA Security+",
                nsaDesignated: false
            },
            // Cybersecurity - Universities
            {
                programArea: "CYBER",
                institution: "University of Maryland, Baltimore County (UMBC)",
                type: "University",
                programs: "Computer Science with Cybersecurity Track, B.S.; Cybersecurity, M.S.",
                certificates: "",
                features: "NSA/DHS CAE-CD and CAE-R designated, CMSC 426, CMSC 441 coursework",
                credentials: "CompTIA Network+, Security+",
                nsaDesignated: true
            },
            {
                programArea: "CYBER",
                institution: "University of Maryland Global Campus (UMGC)",
                type: "University",
                programs: "Cybersecurity Management & Policy, B.S.; Cybersecurity Technology, B.S.; Cybersecurity, M.S.",
                certificates: "",
                features: "NSA CAE-CD designated, CompTIA pathway with CMIT courses",
                credentials: "CompTIA A+, Network+, Security+",
                nsaDesignated: true
            },
            {
                programArea: "CYBER",
                institution: "Towson University",
                type: "University",
                programs: "Computer Science with Cyber Operations Track, B.S.; Information Security Certificate",
                certificates: "Graduate Certificate",
                features: "NSA CAE-CO designated since 2013, ITEC 357 prepares for CompTIA certs",
                credentials: "CompTIA Network+, Security+",
                nsaDesignated: true
            },
            {
                programArea: "CYBER",
                institution: "Bowie State University (BSU)",
                type: "University",
                programs: "Computer Science with Cybersecurity Focus, B.S.; Cyber Operations Engineering, B.S.",
                certificates: "",
                features: "NSA CAE-CD designated since 2009, COSC 478/479 coursework",
                credentials: "CompTIA fundamentals",
                nsaDesignated: true
            },
            {
                programArea: "CYBER",
                institution: "Capitol Technology University",
                type: "University",
                programs: "Cybersecurity, B.S.; Cybersecurity, M.S.",
                certificates: "Computer and Cybersecurity Certificate",
                features: "NSA CAE-CD designated, first two courses prepare for Security+ exam",
                credentials: "CompTIA A+, Network+, Security+, CEH",
                nsaDesignated: true
            },
            {
                programArea: "CYBER",
                institution: "Morgan State University",
                type: "University",
                programs: "Cybersecurity Intelligence Management, B.S.; Advanced Computing with Cybersecurity, M.S.",
                certificates: "",
                features: "NSA CAE-CD certified through 2027, non-technical management focus",
                credentials: "CompTIA Security+ fundamentals",
                nsaDesignated: true
            },
            {
                programArea: "CYBER",
                institution: "University of Maryland, College Park (UMD)",
                type: "University",
                programs: "Cybersecurity, M.Eng.",
                certificates: "Graduate Certificate in Engineering in Cybersecurity",
                features: "Advanced engineering-focused security topics, ENPM courses",
                credentials: "Advanced CompTIA objectives",
                nsaDesignated: false
            },
            {
                programArea: "CYBER",
                institution: "Johns Hopkins University",
                type: "University",
                programs: "Security Informatics, M.S.",
                certificates: "Graduate Certificates in Cybersecurity",
                features: "Multiple concentrations including cryptography, forensics, ethical hacking",
                credentials: "CompTIA CySA+",
                nsaDesignated: false
            },
            {
                programArea: "CYBER",
                institution: "Salisbury University",
                type: "University",
                programs: "Computer Science with Security Track, B.S.",
                certificates: "",
                features: "COSC courses in network security and cryptography",
                credentials: "CompTIA Security+",
                nsaDesignated: false
            },
            // Machine Learning & Data Science - Community Colleges
            {
                programArea: "ML/DS",
                institution: "Montgomery College (MC)",
                type: "Community College",
                programs: "Data Science and Analytics, A.A.S.",
                certificates: "Data Science Certificate",
                features: "Python, R, statistical analysis, ML fundamentals, Tableau, IBM/Google cert prep",
                credentials: "IBM Data Science, Google Data Analytics",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "Prince George's Community College (PGCC)",
                type: "Community College",
                programs: "Data Science and Analysis Certificate",
                certificates: "Data Science and Analysis Certificate",
                features: "Python, pandas, NumPy, machine learning fundamentals, visualization",
                credentials: "IBM Data Science Professional Certificate",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "Community College of Baltimore County (CCBC)",
                type: "Community College",
                programs: "Data Analytics Certificate",
                certificates: "Business Intelligence Analyst Certificate",
                features: "SQL, Python, Tableau, Power BI, predictive analytics, CompTIA Data+ prep",
                credentials: "CompTIA Data+, Google Data Analytics",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "Anne Arundel Community College (AACC)",
                type: "Community College",
                programs: "Computer Science, A.S. with data science electives",
                certificates: "Data Analytics courses (continuing ed)",
                features: "Python programming, database management, statistical analysis",
                credentials: "Foundational data science skills",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "Howard Community College (HCC)",
                type: "Community College",
                programs: "Computer Science, A.A. with Data Science pathway",
                certificates: "Business Analytics Certificate",
                features: "Statistics, Python, database systems, machine learning basics",
                credentials: "IBM Data Science fundamentals",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "Carroll Community College",
                type: "Community College",
                programs: "Computer Science, A.S. with data analytics",
                certificates: "",
                features: "Python and R programming, database management, basic analytics",
                credentials: "Foundational data science",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "College of Southern Maryland (CSM)",
                type: "Community College",
                programs: "Computer Science, A.S.",
                certificates: "",
                features: "Data structures, algorithms, programming, mathematics foundation",
                credentials: "Prerequisites for ML",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "Frederick Community College (FCC)",
                type: "Community College",
                programs: "Computer Science, A.S.",
                certificates: "Data Analytics continuing education",
                features: "Python, SQL, data visualization basics",
                credentials: "Google Data Analytics",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "Harford Community College",
                type: "Community College",
                programs: "Computer Information Systems",
                certificates: "Business Analytics Certificate",
                features: "Database management, reporting, basic predictive analytics",
                credentials: "CompTIA Data+ objectives",
                nsaDesignated: false
            },
            // Machine Learning & Data Science - Universities
            {
                programArea: "ML/DS",
                institution: "University of Maryland, College Park (UMD)",
                type: "University",
                programs: "Data Science, B.S.; Machine Learning Minor; Data Science, M.S.",
                certificates: "",
                features: "CMSC 320, STAT 430, Azure/AWS certification prep",
                credentials: "Microsoft Azure Data Scientist, AWS-SA",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "University of Maryland, Baltimore County (UMBC)",
                type: "University",
                programs: "Data Science, B.S.; Statistics with ML Track, B.S.; Data Science, M.P.S.",
                certificates: "",
                features: "ABET-accredited, DATA 601, ML, deep learning, big data analytics",
                credentials: "IBM Data Science, Microsoft Azure",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "Johns Hopkins University",
                type: "University",
                programs: "Applied Math & Statistics with DS Focus, B.S.; Data Science, M.S.; Applied & Computational Math, M.S.E.",
                certificates: "",
                features: "Advanced ML, neural networks, NLP, computer vision",
                credentials: "Advanced ML/DS, AWS-SA",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "Towson University",
                type: "University",
                programs: "Computer Science, B.S. with DS concentration; Applied IT, M.S. with DS track",
                certificates: "",
                features: "COSC 436 Data Mining, COSC 757 Machine Learning, big data tech",
                credentials: "CompTIA Data+, Azure certifications",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "University of Maryland Global Campus (UMGC)",
                type: "University",
                programs: "Data Analytics, B.S.; Data Analytics, M.S.; Biotechnology with Bioinformatics, M.S.",
                certificates: "",
                features: "Online programs, Python, R, ML, cloud analytics on AWS/Azure",
                credentials: "Google, IBM, Microsoft, AWS certifications",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "Morgan State University",
                type: "University",
                programs: "Computer Science, B.S. with AI/ML concentration; Advanced Computing, M.S. with DS track",
                certificates: "",
                features: "COSC 473 ML, COSC 475 Data Mining, deep learning",
                credentials: "IBM, Microsoft certification objectives",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "Bowie State University",
                type: "University",
                programs: "Computer Science, B.S. with DS electives; Applied Computational Math, M.S.",
                certificates: "",
                features: "Data mining, ML, statistical computing",
                credentials: "Foundational ML/DS competencies",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "Salisbury University",
                type: "University",
                programs: "Data Science, B.S.; Mathematics with Statistics Track, B.S.; Applied Computer Science, M.S.",
                certificates: "",
                features: "COSC/DATA courses in ML, big data, visualization",
                credentials: "CompTIA Data+, cloud certifications",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "Capitol Technology University",
                type: "University",
                programs: "Data Science, B.S.; Data Analytics, M.S.",
                certificates: "",
                features: "Applied data science, predictive analytics, business intelligence",
                credentials: "Industry certification preparation",
                nsaDesignated: false
            },
            {
                programArea: "ML/DS",
                institution: "Hood College",
                type: "University",
                programs: "Computer Science, B.S. with DS concentration; Information Technology, M.S.",
                certificates: "",
                features: "ML, data mining, analytics coursework",
                credentials: "Foundational ML/DS skills",
                nsaDesignated: false
            },
            // Networking - Community Colleges
            {
                programArea: "NET",
                institution: "Montgomery College (MC)",
                type: "Community College",
                programs: "Network and Wireless Technologies, A.A.S.",
                certificates: "Networking Certificate, Cisco Networking Academy",
                features: "CCNA prep, CompTIA Network+/A+, routing/switching, network security",
                credentials: "CompTIA A+, Network+, Cisco CCNA",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "Community College of Baltimore County (CCBC)",
                type: "Community College",
                programs: "Network Technology, A.A.S.",
                certificates: "Computer Networking Certificate, Cisco Academy",
                features: "Network admin, security, virtualization, cloud tech, CompTIA/Cisco prep",
                credentials: "CompTIA A+, Network+, Security+, Cisco certs",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "Anne Arundel Community College (AACC)",
                type: "Community College",
                programs: "Networking, A.A.S.",
                certificates: "Network Administration Certificate, Cisco Academy",
                features: "Network fundamentals, routing protocols, switching, security, wireless",
                credentials: "CompTIA A+, Network+, Cisco objectives",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "Prince George's Community College (PGCC)",
                type: "Community College",
                programs: "Information Technology with Networking, A.A.S.",
                certificates: "Network Administration Certificate",
                features: "Hardware/software support, TCP/IP, network security, virtualization",
                credentials: "CompTIA A+, Network+",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "Carroll Community College",
                type: "Community College",
                programs: "Information Technology, A.A.S. with networking track",
                certificates: "Network Administration Certificate",
                features: "Network installation, configuration, management, troubleshooting",
                credentials: "CompTIA A+, Network+",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "Howard Community College (HCC)",
                type: "Community College",
                programs: "Network Technology, A.A.S.",
                certificates: "Cisco Networking Academy, Network Security Certificate",
                features: "Routing, switching, network design, security",
                credentials: "CompTIA, Cisco certifications",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "College of Southern Maryland (CSM)",
                type: "Community College",
                programs: "Information Systems Technology, A.A.S. with networking",
                certificates: "Network Administration Certificate",
                features: "Network architecture, administration, security, cloud computing",
                credentials: "CompTIA A+, Network+",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "Harford Community College",
                type: "Community College",
                programs: "Computer Information Systems with Networking, A.A.S.",
                certificates: "Network Technology Certificate",
                features: "Hardware, OS, network administration, security",
                credentials: "CompTIA certifications",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "Frederick Community College (FCC)",
                type: "Community College",
                programs: "Information Technology, A.A.S.",
                certificates: "Network Administration Certificate, Cisco Academy",
                features: "Networking with virtualization, cloud computing, security",
                credentials: "CompTIA, Cisco certifications",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "Hagerstown Community College",
                type: "Community College",
                programs: "Information Systems Technology, A.A.S.",
                certificates: "Network Administration pathway",
                features: "Network design, implementation, security, troubleshooting",
                credentials: "CompTIA A+, Network+",
                nsaDesignated: false
            },
            // Networking - Universities
            {
                programArea: "NET",
                institution: "University of Maryland Global Campus (UMGC)",
                type: "University",
                programs: "Computer Networks and Cybersecurity, B.S.",
                certificates: "Network Security Certificate",
                features: "Network design, admin, security, cloud, virtualization, CompTIA/Cisco prep",
                credentials: "CompTIA A+, Network+, Security+, Cisco CCNA",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "Towson University",
                type: "University",
                programs: "Information Technology, B.S. with Networking Technologies track",
                certificates: "Network Administration Certificate",
                features: "ITEC courses in network fundamentals, routing/switching, security, wireless",
                credentials: "CompTIA Network+, Security+",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "University of Maryland, Baltimore County (UMBC)",
                type: "University",
                programs: "Information Systems, B.S. with networking; Computer Science, B.S. with systems",
                certificates: "",
                features: "IS 450/451 Network Design/Admin, comprehensive security",
                credentials: "CompTIA Network+, advanced networking",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "Capitol Technology University",
                type: "University",
                programs: "Network Security, B.S.; Computer Engineering Technology, B.S.",
                certificates: "",
                features: "NSA-designated, hands-on labs, virtualization, cloud networking",
                credentials: "CompTIA Network+, Security+, Cisco",
                nsaDesignated: true
            },
            {
                programArea: "NET",
                institution: "Bowie State University",
                type: "University",
                programs: "Computer Technology, B.S. with Network Security track",
                certificates: "",
                features: "CTEC courses in network admin, security, wireless, cloud",
                credentials: "CompTIA A+, Network+",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "Morgan State University",
                type: "University",
                programs: "Information Systems, B.S.; Electrical & Computer Engineering, B.S.",
                certificates: "",
                features: "Network design, administration, security fundamentals",
                credentials: "CompTIA Network+",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "Salisbury University",
                type: "University",
                programs: "Information Systems, B.S. with networking electives",
                certificates: "",
                features: "Network architecture, administration, security, emerging tech",
                credentials: "CompTIA certifications",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "Frostburg State University",
                type: "University",
                programs: "Information Technology, B.S. with networking concentration",
                certificates: "",
                features: "Network design, implementation, security, management",
                credentials: "CompTIA A+, Network+",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "University of Maryland, College Park (UMD)",
                type: "University",
                programs: "Computer Engineering, B.S.; Electrical Engineering, B.S.",
                certificates: "",
                features: "Advanced network protocols, wireless communications, network security",
                credentials: "Advanced networking, Cisco certifications",
                nsaDesignated: false
            },
            {
                programArea: "NET",
                institution: "Johns Hopkins University",
                type: "University",
                programs: "Computer Science, B.S. with networking",
                certificates: "Information Security Institute programs",
                features: "Advanced networking, distributed systems, network security",
                credentials: "CompTIA Security+, advanced networking",
                nsaDesignated: false
            }
        ];

        let currentFilter = 'all';

        // Institution homepage domains for Source links
        const institutionDomains = {
            'Montgomery College (MC)': 'montgomerycollege.edu',
            'Community College of Baltimore County (CCBC)': 'ccbcmd.edu',
            'Carroll Community College': 'carrollcc.edu',
            'Anne Arundel Community College (AACC)': 'aacc.edu',
            "Prince George's Community College (PGCC)": 'pgcc.edu',
            'College of Southern Maryland (CSM)': 'csmd.edu',
            'Harford Community College': 'harford.edu',
            'Frederick Community College (FCC)': 'frederick.edu',
            'Howard Community College (HCC)': 'howardcc.edu',
            'Garrett College': 'garrettcollege.edu',
            'Baltimore City Community College (BCCC)': 'bccc.edu',
            'University of Maryland, College Park (UMD)': 'umd.edu',
            'University of Maryland, Baltimore County (UMBC)': 'umbc.edu',
            'Johns Hopkins University': 'jhu.edu',
            'Towson University': 'towson.edu',
            'University of Maryland Global Campus (UMGC)': 'umgc.edu',
            'Capitol Technology University': 'captechu.edu',
            'Hood College': 'hood.edu',
            'Morgan State University': 'morgan.edu',
            'Bowie State University': 'bowiestate.edu',
            'Salisbury University': 'salisbury.edu'
        };

        function populateTable(filter = 'all') {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            let filteredData = programData;
            
            if (filter === 'programming') {
                filteredData = programData.filter(row => row.programArea === 'PROG');
            } else if (filter === 'cybersecurity') {
                filteredData = programData.filter(row => row.programArea === 'CYBER');
            } else if (filter === 'ml') {
                filteredData = programData.filter(row => row.programArea === 'ML/DS');
            } else if (filter === 'networking') {
                filteredData = programData.filter(row => row.programArea === 'NET');
            }
            
            filteredData.forEach(row => {
                const tr = document.createElement('tr');
                const typeClass = row.type === 'Community College' ? 'type-community' : 'type-university';
                const programClass = row.programArea === 'PROG' ? 'type-programming' :
                                    row.programArea === 'CYBER' ? 'type-cybersecurity' :
                                    row.programArea === 'ML/DS' ? 'type-ml' : 'type-networking';
                
                const nsaBadge = row.nsaDesignated ? '<span class="designation-badge">NSA/DHS</span>' : '';
                const domain = institutionDomains[row.institution];
                const sourceUrl = domain ? `https://${domain}` : `https://www.google.com/search?q=${encodeURIComponent(row.institution + ' ' + row.programs)}`;
                tr.innerHTML = `
                    <td><span class="program-type ${programClass}">${row.programArea}</span></td>
                    <td><strong>${row.institution}</strong>${nsaBadge}</td>
                    <td><span class="institution-type ${typeClass}">${row.type}</span></td>
                    <td>${row.programs}</td>
                    <td>${row.certificates ? row.certificates.split(',').map(c => `<span class="certificate-tag">${c.trim()}</span>`).join('') : '-'}</td>
                    <td>${row.features}</td>
                    <td>${row.credentials ? row.credentials.split(',').map(c => `<span class="credential-badge">${c.trim()}</span>`).join('') : '-'}</td>
                    <td><a href="${sourceUrl}" target="_blank" rel="noopener">Find program</a></td>
                `;
                tableBody.appendChild(tr);
            });
            
            updateStats(filteredData);
            // Re-apply any active sort after repopulating
            applySort();
        }

        function updateStats(data = programData) {
            document.getElementById('totalPrograms').textContent = data.length;
            document.getElementById('communityColleges').textContent = data.filter(p => p.type === 'Community College').length;
            document.getElementById('universities').textContent = data.filter(p => p.type === 'University').length;
            document.getElementById('certificatePrograms').textContent = data.filter(p => p.certificates !== '').length;
            document.getElementById('nsaDesignated').textContent = data.filter(p => p.nsaDesignated === true).length;
        }

        function selectProgram(program) {
            currentFilter = program;
            
            // Update button states
            document.querySelectorAll('.program-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            populateTable(program);
        }

        function filterTable(type) {
            const rows = document.querySelectorAll('#tableBody tr');
            rows.forEach(row => {
                if (type === 'all') {
                    row.style.display = '';
                } else if (type === 'community') {
                    row.style.display = row.innerHTML.includes('type-community') ? '' : 'none';
                } else if (type === 'university') {
                    row.style.display = row.innerHTML.includes('type-university') ? '' : 'none';
                }
            });
        }

        document.getElementById('searchInput').addEventListener('keyup', function() {
            const searchTerm = this.value.toLowerCase();
            const rows = document.querySelectorAll('#tableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        function exportToExcel() {
            let csvContent = "Program Area,Institution,Type,Programs/Degrees,Certificates,Key Features,Industry Credentials,NSA Designated,Source\n";
            
            programData.forEach(row => {
                const q = encodeURIComponent(`${row.institution} ${row.programs}`);
                const link = `https://www.google.com/search?q=${q}`;
                csvContent += `"${row.programArea}","${row.institution}","${row.type}","${row.programs}","${row.certificates || '-'}","${row.features}","${row.credentials || '-'}","${row.nsaDesignated ? 'Yes' : 'No'}","${link}"\n`;
            });
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', 'Digital_Technology_Cluster_Crosswalk.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Sorting support
        // Multi-column sort (Shift-click to add secondary keys)
        let sortKeys = [];
        function applySort() {
            if (!sortKeys.length) return;
            const tbody = document.getElementById('tableBody');
            const rows = Array.from(tbody.querySelectorAll('tr'));
            rows.sort((a,b) => {
                for (const key of sortKeys) {
                    const ta = (a.children[key.index]?.textContent || '').trim().toLowerCase();
                    const tb = (b.children[key.index]?.textContent || '').trim().toLowerCase();
                    const cmp = ta.localeCompare(tb);
                    if (cmp !== 0) return key.asc ? cmp : -cmp;
                }
                return 0;
            });
            rows.forEach(r => tbody.appendChild(r));
            updateSortIndicators();
        }
        function updateSortIndicators(){
            const ths = document.querySelectorAll('#dataTable thead th');
            ths.forEach((th, idx) => {
                const base = th.dataset.base || th.textContent.trim();
                th.dataset.base = base;
                const pos = sortKeys.findIndex(k => k.index === idx);
                if (pos >= 0) {
                    const asc = sortKeys[pos].asc;
                    th.textContent = `${base} ${asc ? '‚ñ≤' : '‚ñº'}${pos+1}`;
                } else {
                    th.textContent = base;
                }
            });
        }
        // Attach header click listeners
        (function setupSorting(){
            const ths = document.querySelectorAll('#dataTable thead th');
            ths.forEach((th, idx) => {
                th.style.cursor = 'pointer';
                th.title = 'Click to sort (Shift-click to add)';
                th.addEventListener('click', (e) => {
                    const existing = sortKeys.findIndex(k => k.index === idx);
                    if (e.shiftKey) {
                        if (existing >= 0) {
                            // toggle direction
                            sortKeys[existing].asc = !sortKeys[existing].asc;
                        } else {
                            sortKeys.push({ index: idx, asc: true });
                        }
                    } else {
                        if (existing >= 0) {
                            sortKeys = [{ index: idx, asc: !sortKeys[existing].asc }];
                        } else {
                            sortKeys = [{ index: idx, asc: true }];
                        }
                    }
                    applySort();
                });
            });
            updateSortIndicators();
        })();

        // Initialize table on page load
        populateTable();
        // Ensure sort applies after initial render
        applySort();
        // Prevent accidental navigation when dropping files/screenshots onto the page
        window.addEventListener('dragover', function(e){ e.preventDefault(); });
        window.addEventListener('drop', function(e){
            if (e.dataTransfer && e.dataTransfer.files && e.dataTransfer.files.length) {
                e.preventDefault();
                alert('File drop disabled to prevent accidental navigation.');
            }
        });
    </script>
</body>
</html>
